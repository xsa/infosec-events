{{/* Top-year navigation for archives */}}
{{ $items := slice }}
{{ $section := site.GetPage "section" "archives" }}

{{ if $section }}
  {{ range $section.RegularPages }}
    {{ $fname := .File.BaseFileName }}
    {{ if findRE `^(19|20)[0-9]{2}$` $fname }}
      {{ $year := int $fname }}
      {{ $items = $items | append (dict "page" . "year" $year "url" .RelPermalink) }}
    {{ end }}
  {{ end }}

  {{ $currentYear := now.Format "2006" | int }}
  {{ $found := false }}
  {{ range $items }}
    {{ if eq .year $currentYear }}
      {{ $found = true }}
    {{ end }}
  {{ end }}
  {{ if not $found }}
    {{ $items = $items | append (dict "page" nil "year" $currentYear "url" (printf "/archives/%d/" $currentYear)) }}
  {{ end }}

  {{ $items = sort $items "year" "desc" }}