{{/* layouts/partials/archive-nav.html */}}

{{ $section := site.GetPage "section" "archives" }}
{{ if not $section }}
  {{ return }}
{{ end }}

{{ $currentYear := (now.Format "2006" | int) }}
{{ $years := slice }}
{{ $remaining := slice }}

{{/* Collect all year pages */}}
{{ range $section.RegularPages }}
  {{ $fname := .File.BaseFileName }}
  {{ if findRE `^(19|20)[0-9]{2}$` $fname }}
    {{ $year := int $fname }}
    {{ if eq $year $currentYear }}
      {{ $years = $years | append (dict "year" $year "url" .RelPermalink) }}
    {{ else }}
      {{ $remaining = $remaining | append (dict "year" $year "url" .RelPermalink) }}
    {{ end }}
  {{ end }}
{{ end }}

{{/* If no page exists for current year, add a dummy at the front */}}
{{ if eq (len $years) 0 }}
  {{ $years = $years | append (dict "year" $currentYear "url" (printf "/archives/%d/" $currentYear)) }}
{{ end }}

{{/* Sort remaining years descending */}}
{{ $remaining = sort $remaining "year" "desc" }}

{{/* Final list (current year -> others) */}}
{{ $items := $years | append $remaining }}

<nav class="archive-years">
  <ul style="display:flex; gap:1rem; list-style:none; padding:0;">
    {{ range $items }}
      <li><a href="{{ .url }}">{{ .year }}</a></li>
    {{ end }}
  </ul>
</nav>