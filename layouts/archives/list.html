{{/* layouts/archives/list.html */}}
{{ define "main" }}
<main class="container">

  {{/* --- Section header --- */}}
  <header>
    <h1>{{ .Title | default "Archive" }}</h1>
    {{ with .Content }}{{ . }}{{ end }}
  </header>

  {{/* --- Collect all year pages (from mounted files) --- */}}
  {{ $items := slice }}
  {{ range .RegularPages }}
    {{ $fname := .File.BaseFileName }}
    {{ if findRE `^(19|20)[0-9]{2}$` $fname }}
      {{ $year := int $fname }}
      {{ $items = $items | append (dict "page" . "year" $year "url" .RelPermalink) }}
    {{ end }}
  {{ end }}

  {{/* --- Ensure current year is included --- */}}
  {{ $currentYear := now.Format "2006" | int }}
  {{ $found := false }}
  {{ range $items }}
    {{ if eq .year $currentYear }}
      {{ $found = true }}
    {{ end }}
  {{ end }}
  {{ if not $found }}
    {{/* Dummy entry for current year if no file exists yet */}}
    {{ $items = $items | append (dict "page" nil "year" $currentYear "url" (printf "/archives/%d/" $currentYear)) }}
  {{ end }}

  {{/* --- Sort descending (newest first) --- */}}
  {{ $items = sort $items "year" "desc" }}

  {{/* --- Top navigation bar --- */}}
  <nav class="archive-years">
    <ul style="display:flex; gap:1rem; list-style:none; padding:0;">
      {{ range $items }}
        <li>
          <a href="{{ .url }}">{{ .year }}</a>
        </li>
      {{ end }}
    </ul>
  </nav>

  {{/* --- Optional list below nav (can be removed) --- */}}
  <ul class="archive-list">
    {{ range $items }}
      <li>
        <a href="{{ .url }}">{{ .year }}</a>
      </li>
    {{ end }}
  </ul>

</main>
{{ end }}