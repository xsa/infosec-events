{{ define "main" }}
<main class="container container-center">

  <header>
    <h1>{{ .Title | default "Archive" }}</h1>
    {{ with .Content }}{{ . }}{{ end }}
  </header>

  {{/* Top navigation */}}
  {{ partial "archive-nav.html" . }}

  {{/* Show current year content dynamically */}}
  {{ $currentYear := now.Format "2006" }}
  {{ $currentPage := site.GetPage (printf "archives/%s.md" $currentYear) }}
  {{ if $currentPage }}
    <section class="current-year-content">
      {{ $currentPage.Content }}
    </section>
  {{ end }}

  {{/* Optional: list all years below */}}
  <ul class="archive-list">
    {{ $section := site.GetPage "section" "archives" }}
    {{ if $section }}
      {{ $items := slice }}
      {{ range $section.RegularPages }}
        {{ $fname := .File.BaseFileName }}
        {{ if findRE `^(19|20)[0-9]{2}$` $fname }}
          {{ $year := int $fname }}
          {{ $items = $items | append (dict "page" . "year" $year "url" .RelPermalink) }}
        {{ end }}
      {{ end }}

      {{/* Include current year if missing */}}
      {{ $found := false }}
      {{ range $items }}
        {{ if eq .year $currentYear }}{{ $found = true }}{{ end }}
      {{ end }}
      {{ if not $found }}
        {{ $items = $items | append (dict "page" nil "year" $currentYear "url" (printf "/archives/%d/" $currentYear)) }}
      {{ end }}

      {{ $items = sort $items "year" "desc" }}
      {{ range $items }}
        <li><a href="{{ .url }}">{{ .year }}</a></li>
      {{ end }}
    {{ end }}
  </ul>

</main>
{{ end }}