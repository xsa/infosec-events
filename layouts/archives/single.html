{{/* layouts/archives/single.html */}}
{{ define "main" }}
  <main class="container">
    <article>
      <header>
        <h1>{{ .Title }}</h1>
      </header>

      <div class="post-content">
        {{ .Content }}
      </div>

      {{/* Build sorted (desc) list of years for navigation */}}
      {{ $section := .CurrentSection }}
      {{ $items := slice }}
      {{ range $section.Pages }}
        {{ $fname := .File.BaseFileName }}
        {{ if findRE `^(19|20)[0-9]{2}$` $fname }}
          {{ $year := int $fname }}
          {{ $items = $items | append (dict "page" . "year" $year) }}
        {{ end }}
      {{ end }}
      {{ $items = sort $items "year" "desc" }}

      {{/* Find current index safely */}}
      {{ $current := . }}
      {{ $idx := -1 }}
      {{ range $i, $it := $items }}
        {{ if eq $it.page.RelPermalink $current.RelPermalink }}
          {{ $idx = $i }}
        {{ end }}
      {{ end }}

      {{ $len := len $items }}

      {{ if ge $idx 0 }}
        <nav class="archive-nav">
          <ul>

            {{/* Prev = newer year */}}
            {{ if gt $idx 0 }}
              {{ $prev := index $items (sub $idx 1) }}
              <li>
                ← <a href="{{ $prev.page.RelPermalink }}">{{ $prev.year }}</a>
              </li>
            {{ end }}

            {{/* Next = older year */}}
            {{ if lt (add $idx 1) $len }}
              {{ $next := index $items (add $idx 1) }}
              <li>
                <a href="{{ $next.page.RelPermalink }}">{{ $next.year }}</a> →
              </li>
            {{ end }}

          </ul>
        </nav>
      {{ end }}

    </article>
  </main>
{{ end }}